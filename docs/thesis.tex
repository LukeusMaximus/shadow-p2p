% The document class marks this as a thesis, supplying various options that
% control rendering of some standard features (e.g., the cover page).

\documentclass[ % the name of the author
                    author={Luke Murray},
                % the name of the supervisor (preferably including title)
                supervisor={Dr. Simon Hollis},
                % the thesis    title (which cannot be blank)
                     title={Shadow Peer-to-Peer Networks},
                % the thesis subtitle (which can    be blank)
                  subtitle={},
                % the degree programme (from BSc, MEng, MSci, MSc and PhD)
                    degree={MEng},
                % the year of submission
                      year={2013} ]{thesis}

\usepackage{parskip}
\usepackage{comment}
\usepackage[utf8]{inputenc}
\usepackage{amsfonts}
\begin{document}


% =============================================================================

% This section simply introduces the structural guidelines.  It can clearly
% be deleted (or commented out) if you use the file as a template for your
% own thesis: everything following it is in the correct order to use as is.

\section*{Prelude}
\thispagestyle{empty}

A typical thesis will be structured according to a number of standard 
sections described in what follows.  However, it is hard and perhaps
even counter-productive to generalise: the goal of outlining this 
typical structure is {\em not} to be prescriptive, but simply to act 
as a guideline.  In particular, the page counts given are important 
but not absolute: their aim is simply to highlight that a clear, 
concise description is better than a rambling alternative that 
makes it hard to separate important content and facts from trivia.

%~\cite{latexbook1,latexbook2}
You can use this document as a \LaTeX-based
template for your own thesis by simply deleting extraneous sections (e.g., 
this one); keep in mind that the associated {\tt Makefile} could be of
use, in particular since it also executes \mbox{\BibTeX} to deal with the
bibliography.  If you opt not to do this, which is perfectly acceptable,
a standard cover and declaration of authorship produced online via
\[
\mbox{\url{http://www.cs.bris.ac.uk/Teaching/Resources/cover.html}}
\]

% =============================================================================

% This macro creates the standard UoB title page, with information drawn
% from the document class (meaning it is vital you select the correct
% degree title and so on).

\maketitle

% After the title page (which is a special case in that it is not numbered)
% comes the front matter or preliminaries; this macro signals the start of
% such content, meaning the pages are numbered with Roman numerals.

\frontmatter

% This macro creates the standard UoB thesis declaration; on the hard-copy,
% this must be signed by the author in the space indicated.

\makedecl

% LaTeX will automatically generate a table of contents, and also associated 
% lists of figures, tables and algorithms.  The former is a compulsory part
% of the thesis, but if you do not require the latter they can be suppressed
% by simply commenting out the associated macro.

\tableofcontents
\listoffigures
\listoftables
\listofalgorithms
\lstlistoflistings

% The following sections are part of the front matter, but are not generated
% automatically by LaTeX; the use of \chapter* means they are not numbered.

% -----------------------------------------------------------------------------

\chapter*{Executive Summary}

{\bf A compulsory section, of at most $1$ page} 
\vspace{1cm} 

\noindent
This section should pr\'{e}cis the project context, aims and objectives 
and main contributions and achievements; the same section may be called
an abstract elsewhere.  The goal is to ensure the reader is clear about 
what the topic is, what you have done within this topic, {\em and} what 
your view of the outcome is.

The former aspects should be guided by your specification: essentially 
this section is a (very) short version of what is typically the first 
chapter.  The latter aspects should be presented as a concise, factual 
bullet point list that summarises the main contributions and achievements.  
The points will of course differ for each project, but an example is as 
follows:

\begin{quote}
\noindent
\begin{itemize}
\item I spent $120$ hours collecting material on and learning about the 
      Java garbage-collection sub-system. 
\item I wrote a total of $5000$ lines of source code, comprising a Linux 
      device driver for a robot (in C) and a GUI (in Java) that is 
      used to control it.
\item I designed a new algorithm for computing the non-linear mapping 
      from A-space to B-space using a genetic algorithm, see page $17$.
\item I implemented a version of the algorithm proposed by Jones and 
      Smith in [6], see page $12$, corrected a mistake in it, and 
      compared the results with several alternatives.
\end{itemize}
\end{quote}

% Context
% Aims
% Objective
% Contributions
% Achievements

% -----------------------------------------------------------------------------

\chapter*{Supporting Technologies}

{\bf A compulsory section, of at most $1$ page}
\vspace{1cm} 

\noindent
This section should present a detailed summary, in bullet point form, of 
any third-party resources (e.g., hardware and software components) used 
during the project.  Use of such resources is perfectly acceptable: the 
goal of this section is simply to be clear about where and how they are 
used.  The content can focus on the project topic itself (rather than, 
for example, including ``I used \mbox{\LaTeX} to prepare my thesis''); 
an example is as follows:

\begin{quote}
\noindent
\begin{itemize}
\item I used the Java {\tt BigInteger} class to support my implementation 
      of RSA.
\item I used a parts of the OpenCV computer vision library to capture 
      images from a camera, and for various standard operations (e.g., 
      threshold, edge detection).
\item I used an FPGA device supplied by the Department, and altered it 
      to support an open-source UART core obtained from 
      \url{http://opencores.org/}.
\item The web-interface component of my system was implemented by 
      extending the open-source WordPress software available from
      \url{http://wordpress.org/}.
\end{itemize}
\end{quote}

% -----------------------------------------------------------------------------

\chapter*{Notation and Acronyms}

{\bf An optional section, of roughly $1$ or $2$ pages}
\vspace{1cm} 

\noindent
Any well written document will introduce notation and acronyms before their 
use, {\em even if} they are standard in some way: this ensures any reader 
can understand the resulting self-contained content.  

Said introduction can exist within the thesis itself, wherever that is
appropriate.  For an acronym, this is typically achieved at the first point 
of use via ``Advanced Encryption Standard (AES)'' or similar, noting the 
capitalisation of relevant letters.  However, it can be useful to include 
an additional, dedicated list at the start of the thesis; the advantage of 
doing so is that you cannot mistakenly use an acronym, for example, 
before defining it.  An example is as follows:

\begin{quote}
\noindent
\begin{tabular}{lcl}
AES                 &:     & Advanced Encryption Standard            \\
DES                 &:     & Data Encryption Standard                \\
                    &\vdots&                                         \\
${\mathcal H}( x )$ &:     & the Hamming weight of $x$               \\
${\mathbb  F}_q$    &:     & a finite field with $q$ elements        \\
$x_i$               &:     & the $i$-th bit of some bit-sequence $x$ \\
\end{tabular}
\end{quote}

% -----------------------------------------------------------------------------

\chapter*{Acknowledgements}

{\bf An optional section, of at most $1$ page}
\vspace{1cm} 

\noindent
It is common practice (although totally optional) to acknowledge any
third-party advice, contribution or influence you have found useful
during your work.  Examples include support from friends or family, 
the input of your Supervisor, external organisations or persons who 
have supplied resources of some kind (e.g., funding, advice or time),
and so on.

% =============================================================================

% After the front matter comes a number of chapters; under each chapter,
% sections, subsections and even subsubsections are permissible.  The
% pages in this part are numbered with Arabic numerals.  Note that:
%
% - A reference point can be marked using \label{XXX}, and then later
%   referred to via \ref{XXX}; for example Chapter\ref{chap:context}.
% - The chapters are presented here in one file; this can become hard
%   to manage.  An alternative is to save the content in seprate files
%   the use \input{XXX} to import it, which acts like the #include
%   directive in C.

\mainmatter

% -----------------------------------------------------------------------------

\chapter{Contextual Background}
\label{chap:context}

\begin{comment}
{\bf A compulsory chapter, of roughly $10$ pages}
\vspace{1cm} 

\noindent
This chapter is intended to describe the project context, and motivate
the proposed aims and objectives.  Ideally, it is written at a fairly 
high-level, and easily understood by a reader who is technically 
competent but not an expert in the topic itself.

In short, the goal is to answer three questions for the reader.  First, 
what is the project topic, or problem being investigated?  Second, why 
is the topic important, or rather why should the reader care about it?  
For example, why there is a need for this project (e.g., lack of similar 
software or deficiency in existing software), who will benefit from the 
project and in what way (e.g., end-users or software developers, or 
researchers), what work does the project build on and why is the selected 
approach important or interesting (e.g., fills a gap in literature, applies
results from another field to a new problem).  Finally, what are the 
central challenges involved and why are they significant? 
 
The chapter should conclude with a concise bullet point list that 
summarises the aims and objectives.  For example:

\begin{quote}
\noindent
The high-level objective of this project is to reduce the performance 
gap between hardware and software implementations of modular arithmetic.  
More specifically, the concrete aims are:

\begin{enumerate}
\item Research and survey literature on public-key cryptography and
      identify the state of the art in exponentiation algorithms.
\item Improve the state of the art algorithm so that it can be used
      in an effective and flexible way on constrained devices.
\item Implement a framework for describing exponentiation algorithms
      and populate it with suitable examples from the literature on 
      an ARM7 platform.
\item Use the framework to perform a study of algorithm performance
      in terms of time and space, and show the proposed improvements
      are worthwhile.
\end{enumerate}
\end{quote}
\end{comment}

%TODO make longer

% Project topic
The Internet is generally seen as a medium through which free speech can propagate faster and spread wider than was possible before with physical means (e.g. mail, newspaper). Now, more than ever, Internet users can communicate their views, beliefs and opinions unhindered. However, speaking one's mind is not without danger. In some cases, what one says may attract undesirable consequences. For instance, a person remarking that another person's appearance is an affront to mother nature may inspire that person to bestow injury upon the remarker. A trivial solution would be to simply not make such a remark. However, the Internet has made making such statements very easy and usually without consequence through the use of anonymity.

The ability to de-couple the identity of an individual from their views is not unique to the Internet but it is much easier to achieve. If our aforementioned remarker were to send a letter by mail with their remarks written on it then the remarker can retain anonymity by not stating who the letter is from. On the Internet, the same effect can be achieved in a few key strokes. This abundance of anonymity has given rise to a number of websites, all dedicated to allowing one to express one's views anonymously. In some cases, this has given rise to antisocial behaviour, however, there are other cases where anonymity is literally a life saver.

When forming connections between parties, the Internet itself does not provide any information about the person who is using that connection; such information must be provided by the user. Thus, by default, the connection is anonymous. What is provided, however, are the Internet Protocol (IP) addresses of the parties forming the connection. This address could be traced back to an institution, household or individual computer and from this it may be possible to find the identity of the user. For this reason, we define the identity of a user to be their IP address. 

To prevent revealing a user's IP address, numerous solutions have been created that keep users anonymous online. Each of these has its own merits and flaws but they do all have something in common. This is that, in every solution, there is always another party that knows the identity of the user. In these solutions, it is generally the case that the party that knows the user's identity doesn't have any knowledge of what information the user is sending or receiving (due to confidentiality methods used, mainly encryption). Thus the party that knows the identity of a user is unable to link a view, belief or opinion back to them. This is generally considered to be a sufficient level of anonymity.

I argue that there is a use for a higher level of anonymity. On this basis, I have created an anonymity solution that keeps the user anonymous by ensuring that only the user themselves knows their identity and no one else. This way, an extra level of anonymity can be provided; in my network design, it is only with great difficulty that a party can discern whether or not an internet user is participating in the network. This feature is not provided by any other network.

% Why is topic important
%   Why is there a need
%   Who will benefit and in what way
%   What work does project build on
%   Why is selected approach important / interesting
% Central challenges and why they are significant

% Why is there a need / who will benefit
\section{A need for anonymity}

There is a need for anonymity solutions in Internet society. In some places, the rise of the Internet has allowed its users to circumvent censorship measures present in their country. Where before only the public media needed controlling to prevent the dissemination of information, now any user is able to spread news far and wide that a pro-censorship government would otherwise be able to hush. Those users responsible for disseminating information that would otherwise be censored are usually subject to litigation. Obviously, those individuals would be keen to avoid the law.

China has a long history of media censorship and has a well known internet filter called "The Great Firewall of China". The only parties allowed to publish news online are licensed print publishers who already self-regulate their content to avoid being shut down by the state. If a user were to publish material or make statements which contravened the censorship policy, they are usually arrested. It takes as little as signing an online petition or communicating with a foreign political group to be imprisoned. Anonymity is obviously desirable when engaging in politics online, a person can then express themselves fully without fear of retribution from censors.

Censorship is just one of the reasons for using anonymity software. Take, for instance, apostasy; this is the act of giving up one's religion. There are 14 countries where apostasy is illegal and in 9 of these it is punishable by death. Thus, if a person were to become apostate in one of these countries and wanted to discuss it, they would have to do so anonymously or risk losing their life. It would be wise in such cases to take additional measures against having one's identity discovered, above and beyond that already provided.

There are a whole host of other situations where anonymity is desirable.
\begin{itemize}
\item Corporate and government whistle-blowers who don't want to lose their job or face litigation.
\item A bank may wish to scout out new investments without their competitors knowing what they're interested in.
\item Some online market places have been known to engage in price discrimination. By disguising their identity, a customer can secure the same product at a lower price.
\item Law enforcers visiting illicit websites and services in order to collect evidence on them. Without anonymity software, the law enforcer may be shown a different version of the site without illegal content.
\item Secret agents obviously do not wish to be discovered in the field. Directly connecting to a military computer in their home country is a dead give-away, even if the content is encrypted.
\item Anonymous tips cannot be delivered through a simple website as the web server will record the IP address of anyone visiting. Tippers will need anonymity software to cover up their IP address.
\item Individuals may wish to prevent a search engine correlating all their searches. Anonymised records of a user's search terms can lead back to individuals\cite{Aol}.
\end{itemize}

% Work project builds on
\section{Work by others}

My project is heavily influenced by existing solutions to the problem. The systems I will describe here are already available and widely used. These systems are The Tor Project\cite{Tor}, I2P\cite{I2P}, Freenet\cite{Freenet}, GNUnet\cite{GNUnet} and the Gnutella network\cite{Gnutella}. The Phantom Protocol\cite{Phantom} also provides some important contributions to the project but its implementation(s) have not been keenly adopted. Virtual Private Networks (VPNs) will be discussed as an existing solution but these networks ultimately lend nothing to the new network design. 

There are some non-network related applications that provide some useful ideas to the project. One such application is Bitcoin, the P2P virtual currency, which will help in hindering and preventing attacks on the network. 

\subsection{Virtual Private Networks}

VPNs are not peer to peer constructs in most cases. They are collections of computers with many different connections to the Internet, all of which are owned by a single company. The company provides a service to its customers where they may connect through the company's computers to the internet for some subscription fee. When connecting through a VPN, the IP address of the customer is replaced by that of the VPN company which anonymises the user amongst the client base of the company. The connection between the VPN and the customer is securely encrypted which prevents any activity performed by the VPNs being traced back to an individual customer. The level of anonymity that VPNs grant is dependent entirely on the records that the company keeps of the activity of their customers. If the company kept a full record of all activity and some entity, that is hostile to the network, acquired the information then the anonymity of the customers is rendered void. If the company keeps no such record of activity, then the customers will remain anonymous. Sensible customers must first trust that the company doesn not keep logs before using their services. This requirement of trust in a third party is the common fatal flaw of all VPNs; the Peer-to-Peer (P2P) networks described next have no such requirement.

Despite this downside for anonymity, VPNs are generally give customers better performance over P2P networks. It is advantageous for VPN companies to set up their servers with high bandwidth and low latency connections in order to compete with other VPN companies. P2P network nodes can appear anywhere on the Internet, giving rise to varying connection quality. Anonymity concerns can be addressed by forming connections through multiple VPNs. If the VPNs are hosted in different countries and the countries are politically hostile with one another then law enforcement in one country is unlikely to be able to forcibly obtain logs from both VPNs.

\subsection{Tor}

The Tor Project\cite{Tor} is a P2P network originally designed by the U.S. Navy to protect government communications. The software has since been released as open source software and is maintained by numerous volunteers. Users connect to the network by contacting a directory server and retrieving a list of nodes. A client can then establish a path through the Tor network (called a 'circuit') by establishing encrypted tunnels through multiple nodes. The client may then use this circuit to connect to the Internet itself or to one of Tor's 'hidden services' (a service only available if connected to with a Tor client).

The network operates such that no intermediate node that the client tunnels through knows what the client is sending / receiving or which two parties the communication is occurring between. This is guaranteed through cryptographic methods. This eliminates the need for the user to trust any party in the network; unlike with VPNs, an entity cannot obtain a log and discern who communicated with whom. Even if the nodes did keep logs, the entity would not learn which users performed which actions. Only if all intermediate nodes in a circuit are compromised can an adversary learn what actions a given user has performed. As the client is the one who picks the nodes in the circuits it uses the client can avoid picking known hostile nodes and if it picks nodes at random and the vast majority of node are good then the chances of a client making a circuit entirely from a single adversary's nodes is very low.

Tor's contribution is that of 'onion routing' where layers of encryption are sequentially removed by intermediate nodes between the sender and the exit node. Whilst it is not the first application to use this technique it is a clear example of good usage.

\subsection{I2P}

I2P\cite{I2P} or the Invisible Internet Project is a low-level network that constructs secure tunnels between peers. The low-level that the network operates at allows all current internet applications to communicate over the network as if it were the Internet itself making it very versatile. The tunnels that it constructs are one-way in the sense that a tunnel either transfers packets away from the tunnel's owner (an outbound tunnel) or towards them (an inbound tunnel). In order to send messages between peers, a message is sent from a peer down one of its outbound tunnels. The tunnel exit sends the message to the entrance of one the other peer's inbound tunnels which then forwards the message to the receiving peer. The sending peer must first look up the 'lease' for the peer they wish to connect to in the network database and retrieve the address and key material for an inbound tunnel to that peer.

Of use to this project is the way I2P splits the information about a peer's anonymous identity and its real identity with the use of two separate Distributed Hash Tables (DHTs). Additions to the anonymous database are done through an established outbound tunnel which preserves the anonymity of the peer as it does this. Information about the services that the peer hosts or uses are then unconnected to the identity of that peer. In addition, the outbound traffic and inbound traffic are disassociated from one another; this will make attacks that use traffic analysis much harder to execute so the project makes use of this idea as well.

\subsection{Freenet}

Freenet\cite{Freenet} provides distributed data storage and the ability to publish 'Freesites' (websites only visible to the network peers). It is censorship resistant by design; one feature of Freenet is that once some data has been published to the Freenet, the uploader can disconnect and the data is still available to the peers. Another interesting feature is that searching for a piece of data causes it to be spread more widely throughout the network; when a data store replies to a request for some data, all the nodes along the data response path store the data as well. Direct deletion of data is not possible, data can only be 'forgotten' over large periods of time if no peer requests it; note that checking that some data has been forgotten results in that data being remembered and the wait will start all over again.

Important to this project is the way a request for data from the network will not give any information on which node has answered a given request. We will show an application that requests data via a broadcast and receives data responses from the network without knowing where in the network the responses have come from. 

\subsection{GNUnet}

GNUnet\cite{GNUnet} is designed for censorship resistant file sharing. It may be used over a number of different methods of transportation between peers including (but not limited to) IP, HTTP and wireless LAN. Essentially, the network abstracts exactly how the data is transmitted away from the applications that use it. The network employs an economic model that aims to prevent free-loading and attacks on the network by having nodes rate other nodes. Over time the nodes build up a view of how much they trust a given node. When traffic load is high in the network, requests from less trusted nodes are dropped, preventing them from doing further harm.

From this network we take the concept of 'cover traffic' upon which GNUnet seems to rely for the majority of its anonymity. A node may set some threshold and then will only send packets if it is routing enough other traffic through itself in order to disguise its own traffic among the crowd. In my network the function of cover traffic is the same with the added provision of dummy packets so that cover traffic may be generated as required.

\subsection{Gnutella}

Gnutella\cite{Gnutella} was originally designed to have all peers on an equal standing. When a request was sent to the network, it would be flood-broadcasted to all other peers in the network. Peers would then respond back along the route the request took with query results if that node had any. This method of query and response is clearly unsustainable for larger networks and due to Gnutella's  popularity it suffered greatly from this flaw. Nowadays, the Gnutella network is composed of leaf nodes and ultra-peers; Leaf nodes connect only to ultra-peers and ultra-peers connect to large numbers of other ultra-peers. This way the network doesn't suffer from query packet saturation.

\subsection{Phantom}

The Phantom Protocol\cite{Phantom} describes a tunnel based network design with theoretically secure anonymity properties. It claims to be superior to both Tor and I2P in that it isn't vulnerable to some of the same pitfalls. Unlike Tor and I2P, it aims to be completely segregated from the normal Internet and to be compatible with all existing software using a network connection. Whereas Tor forbids large data transfers and dedicates itself mainly to anonymous web browsing, Phantom aims to allow all forms of internet traffic. The tunnel design is obviously similar to that of I2P but it is clear that much more thought has been given to ensuring anonymity throughout tunnel creation and tunnel use.

\subsection{Bitcoin}

Bitcoin\cite{Bitcoin} is a P2P virtual currency where Bitcoins are produced at an almost fixed rate. To do this, the network employs a system of proof of work; a proof of work is a solution to a computationally hard problem which is hard to solve but easy to verify the solution. In order to produce Bitcoins a peer must perform some proof of work before obtaining them. As it takes a lot of computational effort to produce the proof of work, the supply of Bitcoins is limited. This rarity gives the Bitcoins value and this makes it feasible to use Bitcoins as a currency. The proof of work mechanism is further augmented in the network by dynamically changing the threshold at which a proof of work will be accepted. As more computational power gets added to the network, it raises this threshold to dynamically return the production of Bitcoins to the predetermined fixed rate.

In the Shadow P2P network, a proof of work system is used to make attacks on the network hard to execute. When a peer wants to join the network, we first make it produce a proof of work of its identity. If a peer is determined to be hostile and we ban it from the network, the network makes a note to never accept that proof of work again. In order to rejoin the network after being banned, it must first create an entirely new identity and produce a proof of work for that identity. This will severely hinder an attacker's progress in determining the identity of peers in the network.

The dynamic adjustment of the proof of work threshold can be used to future proof the network as computing power increases. We can set the rate of joining the network to be a fixed value (e.g. 3 new peers every minute) and adjust the threshold as needed to maintain the low rate. In contrast to Bitcoin where proofs of work are constantly being sought after, there may not be peers trying to join the network all the time and so proofs of work may be far and few between at times. If the system from Bitcoin were implemented, the threshold would spend a lot of its time decreasing thus making joining the network very easy. Attackers could wait until the threshold is low enough and then mount an attack, rejoining the network with ease. Clearly the system would need modifying before it were fit for use in the network.

With the Bitcoin network it is possible to create a list of all IP addresses that host a Bitcoin client. This list can be assembled by connecting to a client and asking for a list of all clients they are connected to. Then for each address received, connect to those clients and ask for more addresses. Repeat this process until no new IP addresses are found. As stated previously it is the project's aim to make the creation of such a list nearly impossible; it should be very difficult to determine whether a single address participates in the network or not. Therefore this project tries to prevent such a list being created by not creating connections to new nodes where it is unnecessary. Additionally, the network does not implement a command that allows a peer to retrieve the information required to connect to other nodes in the network. These nodes must be communicated with through the nodes assigned as the peer's neighbours.

% Why is selected approach important / interesting
% Central challenges and why they are significant

\section{Reaching the limit of anonymity}

This project aims to try and make a network design that provides more anonymity to its users that any other network currently provides. Even upon reaching this level, the project doesn't stop, it aims to reach for the boundary of what it is possible to provide in terms of anonymity on the internet. In creating this network, I look at both networking and cryptographic methods of providing anonymity. Details of their theoretical design and practical implementation will be considered.

This project attempts to create a network where not only is it infeasible to eavesdrop on traffic or determine who is talking to who but it will also be infeasible (or at least expensive) to determine whether or not a person is participating in the network. This is a feature not provided by any other network design. Whilst it may be of limited use, I have shown that there are scenarios where it is necessary to have such a level of protection. It is therefore important to try to fill this gap in network designs so that there will at least be something of use in these situations.

This idea of 'hard to detect' participation gives rise to a much more intriguing feature of my network design. In all other P2P networks, the peers hold the details required to connect to their neighbours and engage in communication; namely, the peers hold the IP address of their neighbours. Recall that I defined the IP address of a peer to be their identity as this information can easily be traced back to a person or other entity responsible for that IP address. This means that the neighbours of a peer know that peer's identity. This is far from ideal if we wish to protect against entities discovering that a peer is participating in the network. To rectify this flaw, I have designed the network such that \em{a peer's neighbours do not know that peer's IP address}. To clarify, neighbours do hold the peer's IP address but only amongst many others, thus the peer is anonymised by virtue of being 'lost in the crowd'. As may be obvious, the challenge here is to show exactly how communication can occur between peers who are unsure of their peer's IP address (without which, messages cannot be sent to that peer).

On top of the basic communication links between peers, designing a network around anonymity is another major undertaking. I will use the ideas and proven concepts from the existing networks to construct a network that meets the needs of the project's security and anonymity requirements.

The other P2P networks mentioned previously all employ some variant on the mesh network structure. In such networks, connections and disconnections are generally made between peers as is needed to improve network efficiency, or to perform self-healing. This is inconsistent with the requirement of anonymity; if the network is structured such that peers that exchange more data have a higher chance of being directly linked, then it can be determined who is likely to be talking to who. In essence, for the greatest possible level of anonymity, the network structure should not bear any relation to the traffic the network handles. This will tie off any possible leak in identity. Some networks have mechanisms in place for preventing network structure giving away information. In the case of Tor, packets incur random delays as they pass through nodes. This makes it nearly impossible for an adversary being able to tell which packets entering a node correspond to packets exiting that node. This is more of a get-around for a single problem case than a full solution. If there is a large throughput of traffic among a linear sequence of nodes, it is reasonable to assume that there is a bulk transfer between the nodes at the ends of the sequence. Thus there is still information leakage from the structure of the network.

Applications that use the network will need to change the way they operate in order to get the best results. Namely, we look at the case of generic file transfer. Over the Internet this is usually achieved through a TCP connection. The file is broken up into packets and each one is sent from the sender to the receiver. The receiver reassembles the file at their end and sends an acknowledgement to the sender for every packet they have received correctly. The sender resends any packets they have not had acknowledged. As the network deliberately sacrifices efficiency for anonymity, sending two packets per block of data is now a much more cumbersome demand. I will demonstrate that there are more modern technologies that can greatly reduce the number of packets required. This allows for better efficiency in a network which disregards performance.

% -----------------------------------------------------------------------------

\chapter{Technical Background}
\label{chap:technical}

\begin{comment}
{\bf A compulsory chapter, of roughly $10$ to $20$ pages} 
\vspace{1cm} 

\noindent
This chapter is intended to describe the technical basis on which execution
of the project depends.  The goal is to provide a detailed explanation of
the specific problem at hand, and any previous or related work in the area 
(e.g., descriptions of supporting technologies, existing algorithms that 
you use, alternative solutions proposed).  

Put another way, after reading this chapter a non-expert reader should have 
obtained enough background to understand what {\em you} have done, and then
assess how novel, challenging and rigorous your work is.  You might view an 
additional goal as giving the reader confidence that you are able to absorb 
and understand research-level material.
\end{comment}

\section{Shouts}

A 'shout' is the method this project uses for anonymous point to point communication. By analogy, it is as if the sender were shouting to a street full of people behind a wall. The sender cannot be seen by those on the street due to the wall and those on the street all appear to ignore what was shouted. As the receiver acts identically to the rest of the people on the street, the true receiver cannot be determined. To achieve this, the sender is anonymised through the use of IP spoofing and the receiver is anonymised through a broadcast to a list of multiple addresses (a 'shout list').

The act of 'shouting' is defined to be sending packets with their source IP address spoofed to every IP address on the shout list. A 'shout' is all of the packets sent when shouting a single time. When we say a party has obtained a peer's shout, we mean that they have the required information to shout to the peer. This basicallly means that the party has obtained that peer's shout list.

The shout is designed to work against an adversary that aims to identify peers on the network. Our adversary is a realistic one. The adversary is polynomially bounded in computation power and does not have complete network knowledge. In addition, the adversary is restricted to performing actions within a fixed sub-network; we call this the adversary's 'jurisdiction'. Within the sub-network the adversary is assumed to have access to, and control over, all the packets that traverse links into and out of its jurisdiction (gateways). Peers within the sub-network must access the rest of the network through the gateways that the adversary has control of. Restricing the adversary further, it is assumed that identifying the first physical link that a packet has traversed before moving through a gateway is difficult. The network is assumed to comprise of multiple jurisdictions, many of which also have adversaries as described here.

\subsection{Shout Lists}

A shout list is a list of IP addresses, one or more of which corresponds to a peer who is participating in the network. All the other addresses are randomly selected from the set of all IP addresses. This list is created by the receiver and given to the sender. This allows for uni-directional communication from sender to receiver. If the sender wishes to deliver a packet, they send identical packets to all the IP addresses in the shout list. The receiver should receive one of these, however it is not guranteed that they do as the method of packet delivery is unreliable. It should be clear that this method of message delivery is very inefficient; recall that anonymity is our main concern here, any attempts at efficiency are secondary.

The receiver that creates the shout list needs to select a large enough set of IP addresses such that monitoring the physical connections of all the destination IP addresses is infeasible for the adversary. If the adversary learns the shout list, they know that at least one of the destination IP addresses belongs to a peer. The adversary can see packets going to and from one of the shout list addresses but as any shout will have its source address spoofed, they will not be able to tell which address in the shout list is doing the responding. The adversary must then proceed to monitor each of the physical links between the individual IP addresses and the nearest node responsible for multiple IP addresses. If the adversary detects spoofed IP packets travelling away from the single IP address destination, it may be assumed that the IP address belongs to a peer participating in the network. Therefore, the idea is to make such a trace as laborious and time consuming as possible by increasing the number of IP addresses in the shout list to a point where an adversary is dissuaded from performing the search.

It is also worth considering which IP addresses we pick for the list. If we spread the IP addresses randomly among jurisdictions, it gives each jurisdiction fewer IP addresses to search through and distributes the search workload. As peers should not wish to help out adversaries in this fashion, the receiver should choose IP addresses within the same jurisdiction. The same logic may apply to sub-jurisdictions (should they exist). On the other hand, spreading them amongst multiple jurisdictions may lead to the adversary ignoring the shouting to IP addresses in its jurisdiction as there are only a small number of them. As there is a high chance that the destination is not in the jurisdiction, it would make the search a wasted effort. The adversary would be wiser to spend its limited resources elsewhere where there may be better odds of discovering a peer.

Above, it has been assumed that the adversary has gained a copy of the shout list. In the network, shout lists are not freely distributed but rather delivered to those with a need to know (i.e. a peer's neighbors). It is possible for an adversary to become a peer's neighbor but this adds an additional hurdle to performing the search. Without the shout list it is next to impossible to discern which traffic belongs to the network and which doesn't. An adversary might observe a packet with a spoofed IP address enter its jurisdiction through one gateway whilst legitimate packets with that source IP address are expected to enter through another. In this case, spoofed IP packets might be distinguished from all others. In either case, it should not be possible for an adversary without a shout list to tell packets from different shouts apart.

%TODO explain mimicing all other destinations. Some destinations may respond to a shout even though they aren't the destination.

\subsection{IP spoofing}

IP spoofing is easily achieved, the protocol itself requires the sender to set the source IP address field to their assigned IP address. There is no reason the sender cannot set this to some other arbitrary value. However, sending packets with spoofed source IP addresses requires additional effort.

Ideally, the sender should set this field to a random address for every packet sent. If they were to use a single address, then an adversary might be able to block all packets coming from that address and thus prevent the communication occurring. This also increases the difficulty for the adversary if it is trying to perform pattern analysis of the traffic the sender sends. In reality, the Internet's routers block packets with obviously spoofed IP addresses. Therefore, before engaging in communication with the network, peers needs to ascertain which IP addresses they can actually spoof. It is suggested that the peer sends test packets with spoofed source IP addresses to some machine they have control over and then get that machine to report which IP addresses were successful as spoofed source addresses. These addresses should then make up the pool from which spoofed source addresses are randomly chosen.

% TODO cite current state of IP spoofing affairs.

\subsection{User Datagram Protocol (UDP)}

UDP is a very basic protocol on the top of IP. It simply adds the use of a virtual 'port'. It is desirable for use in the network because it is stateless and uni-directional. Because the shout removes the sender's true IP from each packet, the receiver has no means of replying to any packet received so a bi-directional protocol such as TCP is inappropriate.

Whilst we could give the receiver the shout for the sender, forming bi-directional communication should be avoided. The reasoning behind this is that packets travelling between two endpoints will take the shortest route. It follows that if the communication is bi-directional, messages travelling in both directions will take the same route. If an adversary is eavesdropping at some point along the path, they will pickup both directions of traffic. As it is likely the traffic will have multiple routes out of a jurisdiction, packets being shouted by the sender are likely to exit via multiple gateways. The responses coming back to the sender return along the shortest route so the adversary, who listens at all of the gateways, will be able to reduce the number of possible locations that the receiver is in. To avoid this, the network will allow messages to be returned to the sender along multiple routes which prevents this reduction.

\section{Shout Groups}

To maintain anonymity we require that sender and receiver peers do not know the other's IP address. The sender is protected through IP spoofing and never gives its own IP address to the receiver. The receiver, however has given their IP to the sender by placing it somewhere in the shout list. Here, we assume that there are two peers, A and B, who have exchanged their shouts. As stated previously, we don't do this in the actual network as bi-directional communication is to be avoided, we do it here only for simplicity. Assume A can request some data from B and get a response; A first shouts its requst to B and B then shouts the response to A. If A wants to learn the IP address of B it could do so simply by searching the shout list. A chooses half of B's shout list and sends a request, if A receives a response from B then B's IP address is in that half of the shout list, otherwise B's IP address is in the other half. A can then split that half again and repeat the process. This continues until A finds a single address which will result in a response when a request is sent to it. Logically, this is B's IP address and the anonymity granted by the shout list has been broken.

Shout Groups are a method of preventing such searches. Mutliple receivers share the same shout so that shouting to it will cause all the receivers to receive a message. In essence, each receiver puts their IP address into the list. We can now prevent against searches by requiring that the packet must be received by all the receivers in the shout list before a response is sent. This brings up more issues. How do the receivers tell each other that they've received the message? What if the adversary controls one of the receivers? What if we used a linear search instead of a binary one? The following sections address these issues.

\subsection{Preventing Search}

The search the adversary performs works on the principle that there are subsets of IP addresses in the shout list that will cause a response to be given by the receiver if a request is sent to just that subset. If shouting to the subset yields a response then the subset contains at least one IP address of a peer. As mentioned previously, we operate such that only if all of the receivers receive a message do we send a response. With this in mind, if we were to conduct a binary search, two randomly chosen halves of the full shout list are unlikey to have all the receivers in one half therefore neither subset will result in a response being sent when shouted to. Even if the adversary manages to get lucky with the split, they still have to repeat the process several more times with more lucky splits required. This thwarts this method of search.

Consider instead a linear search where the subset the adversary sends to starts out as the entire shout list. Every time shouting to the subset yields a response, remove an IP address from the set. If the subset does not yield a response, then the last IP removed from the subset must be a peer. Replace this IP address in the subset and remove another one. Repeat until all the IP addresses have been removed at least once; the remaining IP addresses are all peers. Clearly a better method of defense is needed against shout list search.

To do this we need to use a probablistic defense. Consider again the linear search; we can detect an adversary because the number of receivers their request hits sometimes decreases by one. If the receivers keep giving responses to the adversary, even when it doesn't send to all the receivers, then the adversary will not be able to tell if the IP address they removed is a peer or not. The receivers stop giving responses to any further request by the adversary at some random point after the search was detected. This cut-off has to come before the adversary removes all of the peers from the subset it sends to or none of the receivers will be able to respond to the request (at which point the adversary may assume that the last IP address they removed was a peer's IP address). Another consideration is that if the shout group does a random cut-off after the adversary stops sending to a single node, then the adversary would be able to use a strategy whereby they send multiple requests to a given search subset until they trigger the random cut-off. This again allows the adversary to determine whether or not the last IP address they removed belonged to a peer.

A formal description of the problem is as follows. We have an adversary, $A$, the set of IP addresses in the shout list, $L$, and the set of IP addresses belonging to receivers in the shout group, $V,\forall v \in V, v \in L$. The goal of $A$ is to output $x \in V$ with only knowledge of $L$; to do this, $A$ interacts with an oracle, $B$. We aim to construct, $B$, so that $A$ will output $x \in V$ with probability equal to if $A$ had randomly picked a member of $L$. $A$ and $B$ know $L$, $A$ knows $S$ but not $V$ and $B$ knows $V$ but not $S$.

\[Pr[x \in V] = Pr[l \in V \;\exists l \in L]\]

B takes $S \subseteq L$ and returns $a = \left\{0,1\right\}$. $0$ indicates that sending a shout to the subset $S$ does not yield a response wheras $1$ indicates the opposite. $B$ may choose to stop responding to requests from $A$ at any time, this represents that the shout group has cut-off the adversary. A must then give an output.

Consider the case where we cut-off the adversary at some random point after the adversary stops sending to half of the addresses in $V$. The adversary will then have two sets $S$ and $(L - S)$ with roughly half of the addresses in $L$ in each. These are two sets that could have been created by having A randomly splitting the addresses in $L$ and would have required almost no knowledge from $B$. I say 'almost' because both subsets will contain exactly $\frac{|V|}{2}$ IP addresses that are in $V$ wheras if the set $S$ were picked randomly then we would expect the number of addresses from $V$ that $S$ contains to be binomially distributed: \[Pr(|V \cap S| = \frac{|V|}{2}) = {n \choose k}p^{k}(1-p)^{k}\]\[n = |V|, p = \frac{1}{2}, k = \frac{|V|}{2}\] Therefore, in order to make the sets appear more indistinguishable from the binomial, $B$ should perform the cut-off at some random point after it appears that $A$ stops sending to some threshold, $t$, of addresses in $V$ and before $A$ stops sending to $|V| - t$ addresses in $V$ for some $t$ where $1 \leq t \leq \frac{|V|}{2} \leq |V| - t \leq |V|$. This gives the adversary less information than before; now $S$ may contain between $t$ and $|V| - t$ members of $V$ instead of it being guaranteed to contain $\frac{|V|}{2}$ of them.

Whilst we cannot produce perfect indistinguishability, it has been shown that we can drastically restrict the information that the adversary can learn from a single set of interactions with the shout group (this set of interactions being from first contact with the shout group to when it is cut-off). The adversary will have to use multiple sets of interactions with the shout group in order to better build a pattern and distinguish members of $V$ from members of $L$. As will be discussed, we implement a proof-of-work scheme in order to greatly slow the collection of data points.

% TODO add rigor
% TODO rate of search estimation

\subsection{Message Receipt Verification}

The shout group has previously been assumed to be a group of nodes who all explicity trust each other and none of whom are adversarial to the purpose of the shout group. However, unless users of the network create a shout group amongst a group of themselves who they all mutually trust, there need to be mechanisms in place to prevent an adversary breaking the anonymity granted by the shout group. If an adversary exists amongst the shout group then they can see which nodes have received which messages. With this information it is trivial to simply send a packet to each IP address in the list and see if a member of the shout group states that they have received the message; if the message has been received by a member then the IP address that that message was sent to is the true IP address of a shout group member.

The ideal mechanism has properties as follows. We define $P$ to be the set of receipt maker nodes (or "provers") and $V$ to be the set of receipt verifying nodes (or "verifiers"). The ideal system would allow a message to be accepted (or 'receipted') if and only if $t$ or more provers produce a receipt for it. If $t - 1$ or fewer provers produce a receipt then any member of $V$ cannot determine if any member of $P$ has received the message, or how many of them have received it. If $t$ or more provers produce a receipt then the number of provers that received the message is known. A prover cannot produce a receipt for a message more than once, nor can they forge another provers's receipt for the message.

Initial attempts to solve this problem looked into method's of secret sharing. First, we restrict our problem such that there is only one verifier node; this is the message recipient. It is likely that a message is only intended to be received by one member of the shout group and this restriction represents this case. Additionally, we restrict the sets $P$ and $V$ to be mutually exclusive in membership. Now, each secret sharing scheme has some secret that is to be shared and a system from which those shares are generated. If each prover produces some share in the system and then sends them to the verifier, they will be able to determine the secret if $t$ or more valid shares are received. The barriers to implementing such a scheme are that the provers have to agree upon a system in which to create the shares without letting the verifier know the details of the system. For instance, if we were to use Shamir's scheme\cite{Shamir} we would set $a_0$ to be some cryptographic hash of the message and set the coefficients of the polynomial to be random $a_i \in \mathbb{R}$ for $i \in {1 \ldots t-1}$. The nodes must agree upon the same random values or the secret cannot be recovered. Additionally, revealing the coefficients to the verifier will allow the verifier to produce more shares in the system and thus they can simply produce $t-1$ shares to combine with any given share from a prover and recover the secret. This would reveal that a single prover has received the message and this breaks the conditions for our system's security.

This method of verification can be achieved through the use of a Cryptographically Secure Pseudo Random Number Generator (CSPRNG) whereby we have all the provers use a multi party key agreement protocol (possibly as in \cite{just1996authenticated}) to agree upon a seed. With the same seed, the CSPRNG will produce the same outputs and therefore a prover can generate shares in random secret sharing systems autonomously from the other provers. Now even if the verifier is an adversary, they cannot gain knowledge of whether a message sent to a single IP address has had a receipt produced for it. Only if the more than the threshold of receipts are made will they know. Unfortunately this relies on the provers all being mutually trusted; if a prover is under the control of the adversary then that prover can give the adversary the CSPRNG seed and then the adversary can generate $t-1$ arbitrary shares and find if a single node has produced a message as before.

% TODO possibly talk about Asmuth-Bloom
% TODO choose t to be same as in preventing search

\section{Hiding Public Keys}

The peers in the network maintain confidentiality in their communications through the use of symmetric and asymmetric key cryptography. When sending packets to a given receiver, generally a form of hybrid encryption is used where the bulk of the data is encrypted symmetrically and the key for this is then encrypted under the receiver's public key. This is a widely used methodology %citation needed
however in Shadow P2P, there is a drawback. The onion routing method I intend to use will involve intermediate nodes adding layers of encryption onto packets in order to alter packets going into a node so that the packets are unrecognisable when leaving the node. This is done through symmetrically encrypting the packet under a secret key and then encrypting this key asymmetrically. The problems here are that:
\begin{enumerate}
\item The public key will be part of the packet and this cannot change as it passes through the node as it would render the public key unusable. This would allow an adversary to recognise a packet that exits the node as a specific packet that entered it because the public key that the packets bear is the same.
\item If the adversary has control of the node, it can tell which node the packet is destined for by comparing the public key on the packet with the known public keys of all the other nodes in the network.
\end{enumerate}
Both of these are a threat to anonymity, the adversary gains knowledge of the where the packet is heading and possibly information on where it came from.

To avoid this, I have invented a method of manipulating public keys such that they cannot be recognised as above and so that they can still be used for encryption. This method does not work with every public key methodology however it is known to work with the ElGamal cryptosystem\cite{elgamal1985public}. It will therefore be described as applied to ElGamal in this section.

\subsection{Applied with ElGamal}

\begin{algorithm}[t]
\KwData{The group parameters, $(G, g, q)$, the public key, $h$ and the message $m$.}
\KwResult{The ciphertext pair $(c_1, c_2)$.}
    select a random $y = \left\{1 \ldots q\right\}$\\*
    $c_1 = g^{y}$\\*
    $m\prime = m$ converted to a member of $G$\\*
    $s = h^{y}$\\*
    $c_2 = m\prime.s$\\*
    $return (c_1, c_2)$
\caption{ElGamal encryption.}
\label{ElGamal-enc}
\end{algorithm}
\begin{algorithm}[t]
\KwData{The group parameters, $(G, g, q)$, the private key, $x$ and the ciphertext pair $(c_1, c_2)$}
\KwResult{The message $m$}
    $s = c_1^{x}$\\*
    $m\prime = c_2.s^{-1}$\\*
    $m = m\prime$ deconverted from a member of $G$\\*
    return $m$\\*
\caption{ElGamal decryption.}
\label{ElGamal-dec}
\end{algorithm}
\begin{algorithm}[t]
\KwData{The group parameter, $g$, and the public key, $h$}
\KwResult{The hidden generator, $g\prime$, and the hidden public key, $h\prime$}
    select a random $r = \left\{1 \ldots q\right\}$\\*
    $g\prime = g^{r}$\\*
    $h\prime = h^{r}$\\*
    return $g\prime,h\prime$\\*
\caption{ElGamal public key hiding.}
\label{ElGamal-hide}
\end{algorithm}

In ElGamal, encryption and decryption are performed as in algorithm is performed as in \ref{ElGamal-enc} and \ref{ElGamal-dec}. To hide the public key, $h$, we take both $h$ and $g$ and perform the hiding as described in \ref{ElGamal-hide}. The hidden public key is then the pair (). The value of $r$ in \ref{ElGamal-hide} bears no relation to the value of $y$ that used in \ref{ElGamal-enc} and, in fact, when they are selected by the same party, they should be different. If $y$ and $r$ are the same, the value of $h\prime$ can be used to decrypt ciphertexts encrypted with the ephemeral key $y$ as $h\prime = h^{r} = h^{y} = s$.

Encryption under a hidden public key is as in \ref{ElGamal-enc} but changing the parameters such that $(G, g, q) \rightarrow (G, g\prime, q)$ and $h \rightarrow h\prime$. Decryption is performed identically to \ref{ElGamal-dec} with no change in parameters. The decryption algorithm still works because:
\[c_1 = g\prime^{y} = g^{ry}\]
\[c_2 = m\prime.h\prime^{y} = m\prime.h^{ry} = m\prime.g^{xry}\]
\[m\prime = c_2.c_1^{-x} = m\prime.g^{xry}.g^{-xry}\]
Hopefully it is also apparent that the hiding algorithm can be applied as many times as is desired whilst still maintaining the key's usability. Also note that no matter the number of times the key has been scrambled, the decrypting party still need only perform one exponentiation which is a useful side effect in terms of effeciency. 

In terms of security, the anonymity holds as long as it is hard to compute discrete logarithms in $G$. If this is not the case then $r = \log{g}g\prime$ can be found easily and then an adversary need only compare $h\prime$ with $k^{r} \forall k \in K$ (where $K$ is the set of public keys the adversary holds) in order to find who the public key belongs to. Additionally, the group parameters should be shared between all parties in order to anonymise the recipient among them; otherwise $G$ and $q$ need to be provided for the encryption and the recipient could be identified from these.

\subsection{Applied with Elliptic Curves}

Specifically, this method of hiding can also be applied to the Elliptic Curve Integrated Encryption Scheme (ECIES)\cite{ECIES}. As in ElGamal, the generator and public key are transformed with the same random number to get a hidden public key pair. In this case, the group generator, $G$, is hidden by computing $G\prime = r.G$ and the public key, $K$, is hidden by computing $K\prime = r.K$. For encryption, the value $R = y.G\prime$ is generated with some random $y$ and the shared secret $S = y.K\prime$ is computed. This S is then used to derive keys for a symmetric encryption scheme and a Message Authentication Code (MAC) scheme. When decryption occurs, the private key, $k$, is used to compute the shared secret, $S = k.(y.G\prime)$. The shared secret is then used to derive the keys as done by the encyrpting party, as these keys are the same, decryption and authentication of the data can occur.

% -----------------------------------------------------------------------------

\chapter{Project Execution}
\label{chap:execution}

{\bf A topic-specific chapter, of roughly $20$ pages} 
\vspace{1cm} 

\noindent
This chapter is intended to describe what you did: the goal is to explain
the main activity or activities, of any type, which constituted your work 
during the project.  The content is highly topic-specific, but for many 
projects it will make sense to split the chapter into two sections: one 
will discuss the design of something (e.g., some hardware or an algorithm), 
inc. any rationale or decisions made, and the other will discuss how this 
design was realised via some form of implementation.  

This is, of course, far from ideal for {\em many} project topics.  Some
situations which clearly require a different approach include:

\begin{itemize}
\item In a project where asymptotic analysis of some algorithm is the goal,
      there is no real ``design and implementation'' in a traditional sense
      even though the activity of analysis is clearly within the remit of
      this chapter.
\item In a project where analysis of some results is as major, or a more
      major goal than the implementation that produced them, it might be
      sensible to merge this chapter with the next one: the main activity 
      is such that discussion of the results cannot be viewed separately.
\end{itemize}

\noindent
Note that evidence of ``best practice'' project management (e.g., use of 
version control, choice of programming language and  so on) should only 
be included if there is a clear reason to do so.

\section{Example Section}

This is an example section; 
the following content is auto-generated dummy text.
\lipsum

\subsection{Example Sub-section}

\begin{figure}[t]
\centering
foo
\caption{This is an example figure.}
\label{fig}
\end{figure}

\begin{table}[t]
\centering
\begin{tabular}{|cc|c|}
\hline
foo      & bar      & baz      \\
\hline
$0     $ & $0     $ & $0     $ \\
$1     $ & $1     $ & $1     $ \\
$\vdots$ & $\vdots$ & $\vdots$ \\
$9     $ & $9     $ & $9     $ \\
\hline
\end{tabular}
\caption{This is an example table.}
\label{tab}
\end{table}

\begin{algorithm}[t]
\For{$i=0$ {\bf upto} $n$}{
  $t_i \leftarrow 0$\;
}
\caption{This is an example algorithm.}
\label{alg}
\end{algorithm}

\begin{lstlisting}[float={t},caption={This is an example listing.},label={lst},language=C]
for( i = 0; i < n; i++ ) {
  t[ i ] = 0;
}
\end{lstlisting}

This is an example sub-section;
the following content is auto-generated dummy text.
Notice the examples in Figure~\ref{fig}, Table~\ref{tab}, Algorithm~\ref{alg}
and Listing~\ref{lst}.
\lipsum

\subsubsection{Example Sub-sub-section}

This is an example sub-sub-section;
the following content is auto-generated dummy text.
\lipsum

\paragraph{Example paragraph.}

This is an example paragraph; note the trailing full-stop in the title,
which is common style intended to ensure it does not run into the text.

% -----------------------------------------------------------------------------

\chapter{Critical Evaluation}
\label{chap:evaluation}

{\bf A topic-specific chapter, of roughly $10$ pages} 
\vspace{1cm} 

\noindent
This chapter is intended to evaluate what you did.  The content is highly 
topic-specific, but for many projects will have flavours of the following:

\begin{enumerate}
\item functional testing, inc. analysis of failure cases,
\item performance results, and analysis of said results that draw some 
      form of conclusion,
      and
\item evaluation of options and decisions within the project, and/or a
      comparison with alternatives.
\end{enumerate}

\noindent
This chapter often acts to differentiate project quality: even if the work
completed is of a high technical quality, critical yet objective evaluation 
and comparison of the outcomes is crucial.  In essence, the reader wants to
learn something, so the worst examples amount to simple statements of fact 
(e.g., ``graph X shows the result is Y''); the best examples are analytical 
and exploratory (e.g., ``graph X shows the result is Y, which means Z; this 
contradicts [1], which may be because I use a different assumption'').  As 
such, both positive {\em and} negative outcomes are valid {\em if} presented 
in a suitable manner.

% -----------------------------------------------------------------------------

\chapter{Conclusion}
\label{chap:conclusion}

{\bf A compulsory chapter, of roughly $2$ pages} 
\vspace{1cm} 

\noindent
The concluding chapter of a thesis is often underutilised, in part because
it is often left until close to the deadline and hence does not get enough 
attention.  Ideally, the chapter will consist of three parts:

\begin{enumerate}
\item (Re)summarise the main contributions and achievements, in essence
      summing up the content.
\item Clearly state the current project status (e.g., ``X is working, Y 
      is not'') and evaluate what has been achieved with respect to the 
      initial aims and objectives (e.g., ``I completed aim X outlined 
      previously, the evidence for this is within Chapter Y'').  There 
      is no problem including aims which were not completed, but it is 
      important to evaluate and/or justify why this is the case.
\item Outline any open problems or future plans.  Rather than treat this
      only as an exercise in what you {\em could} have done given more 
      time, try to focus on any unexplored options or interesting outcomes
      (e.g., ``my experiment for X gave counter-intuitive results, this 
      could be because Y and would form an interesting area for further 
      study'').
\end{enumerate}

% =============================================================================

% Finally, after the main matter, the back matter is specified.  This is
% typically populated with just the bibliography.  LaTeX deals with these
% in one of two ways, namely
%
% - inline, which roughly means the author specifies entries using the 
%   \bibitem macro and typesets them manually, or
% - using BiBTeX, which means entries are contained in a separate file
%   (which is essentially a databased) then inported; this is the 
%   approach used below, with the databased being thesis.bib.
%
% Either way, the each entry has a key (or identifier) which can be used
% in the main matter to cite it, e.g., \cite{X}, \cite[Chapter 2}{Y}.

\backmatter

\bibliography{thesis}

% -----------------------------------------------------------------------------

% The thesis concludes with a set of (optional) appendicies; these are the
% same as chapters in a sense, but once signaled as being appendicies via
% the associated macro, LaTeX manages them appropriatly.

\appendix

\chapter{An Example Appendix}
\label{appx:example}

Content which is not central to, but may enhance the thesis can be
included in one or more appendices; examples include, but are not 
limited to

\begin{itemize}
\item lengthy mathematical proofs, numerical or graphical results
      which are summarised in the main body,
\item sample or example calculations, 
      and
\item results of user studies or questionnaires.
\end{itemize}

\noindent
Note that in line with most research conferences, the marking panel 
is not obliged to read such appendices.

% =============================================================================

\end{document}
